<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>ThumbsApp â€¢ Premium Arena</title>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <style>
    /* ============ TAILWIND INJECTION + CUSTOM STYLES ============ */
    *,:after,:before {
      box-sizing: border-box;
      border: 0 solid #e5e7eb;
    }
    
    :root {
      /* Light theme */
      --background: 210 40% 98%;
      --foreground: 222 47% 11%;
      --card: 0 0% 100%;
      --card-foreground: 222 47% 11%;
      --primary: 217 91% 60%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96%;
      --secondary-foreground: 222 47% 11%;
      --muted: 210 40% 96%;
      --muted-foreground: 215 16% 47%;
      --accent: 262 83% 58%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 84% 60%;
      --destructive-foreground: 210 40% 98%;
      --success: 142 71% 45%;
      --success-foreground: 210 40% 98%;
      --warning: 38 92% 50%;
      --warning-foreground: 210 40% 98%;
      --border: 214 32% 91%;
      --input: 214 32% 91%;
      --ring: 222 47% 11%;
      --radius: 1rem;
      --font-inter: 'Inter', system-ui, sans-serif;
      --font-space-grotesk: 'Space Grotesk', sans-serif;
    }
    
    .dark {
      --background: 222 47% 11%;
      --foreground: 210 40% 98%;
      --card: 222 47% 11%;
      --card-foreground: 210 40% 98%;
      --border: 217 33% 17%;
      --muted: 217 33% 17%;
      --muted-foreground: 215 20% 65%;
    }
    
    /* Base styles */
    html {
      line-height: 1.5;
      -webkit-text-size-adjust: 100%;
      font-family: var(--font-inter), system-ui, sans-serif;
    }
    
    body {
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
      margin: 0;
      line-height: inherit;
      transition: background-color 0.3s, color 0.3s;
    }
    
    /* Utility classes */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border-width: 0;
    }
    
    .fixed { position: fixed; }
    .absolute { position: absolute; }
    .relative { position: relative; }
    .sticky { position: sticky; }
    .inset-0 { inset: 0; }
    .top-0 { top: 0; }
    .left-0 { left: 0; }
    .right-0 { right: 0; }
    .bottom-0 { bottom: 0; }
    .top-1\/2 { top: 50%; }
    .-top-1 { top: -0.25rem; }
    .-right-1 { right: -0.25rem; }
    .-right-2 { right: -0.5rem; }
    .-bottom-1 { bottom: -0.25rem; }
    .-bottom-2 { bottom: -0.5rem; }
    .top-4 { top: 1rem; }
    .right-4 { right: 1rem; }
    .left-3 { left: 0.75rem; }
    .top-24 { top: 6rem; }
    .z-50 { z-index: 50; }
    .z-10 { z-index: 10; }
    
    .mx-auto { margin-left: auto; margin-right: auto; }
    .my-4 { margin-top: 1rem; margin-bottom: 1rem; }
    .mt-1 { margin-top: 0.25rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-3 { margin-top: 0.75rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-6 { margin-top: 1.5rem; }
    .-mt-12 { margin-top: -3rem; }
    .mb-1 { margin-bottom: 0.25rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mr-1 { margin-right: 0.25rem; }
    .mr-2 { margin-right: 0.5rem; }
    .ml-2 { margin-left: 0.5rem; }
    .ml-6 { margin-left: 1.5rem; }
    
    .block { display: block; }
    .inline-block { display: inline-block; }
    .flex { display: flex; }
    .inline-flex { display: inline-flex; }
    .grid { display: grid; }
    .hidden { display: none; }
    
    .h-2 { height: 0.5rem; }
    .h-3 { height: 0.75rem; }
    .h-4 { height: 1rem; }
    .h-5 { height: 1.25rem; }
    .h-6 { height: 1.5rem; }
    .h-8 { height: 2rem; }
    .h-10 { height: 2.5rem; }
    .h-12 { height: 3rem; }
    .h-16 { height: 4rem; }
    .h-24 { height: 6rem; }
    .h-48 { height: 12rem; }
    .h-full { height: 100%; }
    .h-screen { height: 100vh; }
    .min-h-screen { min-height: 100vh; }
    .max-h-32 { max-height: 8rem; }
    .max-h-96 { max-height: 24rem; }
    
    .w-2 { width: 0.5rem; }
    .w-3 { width: 0.75rem; }
    .w-4 { width: 1rem; }
    .w-5 { width: 1.25rem; }
    .w-6 { width: 1.5rem; }
    .w-8 { width: 2rem; }
    .w-10 { width: 2.5rem; }
    .w-12 { width: 3rem; }
    .w-16 { width: 4rem; }
    .w-24 { width: 6rem; }
    .w-full { width: 100%; }
    .w-64 { width: 16rem; }
    .max-w-\[1440px\] { max-width: 1440px; }
    .max-w-2xl { max-width: 42rem; }
    .max-w-md { max-width: 28rem; }
    .max-w-sm { max-width: 24rem; }
    
    .flex-1 { flex: 1 1 0%; }
    .flex-shrink-0 { flex-shrink: 0; }
    
    .-translate-y-1\/2 { transform: translateY(-50%); }
    .scale-110 { transform: scale(1.1); }
    .-rotate-90 { transform: rotate(-90deg); }
    
    @keyframes pulse-ring {
      0% { transform: scale(0.8); opacity: 0.8; }
      100% { transform: scale(1.2); opacity: 0; }
    }
    .animate-pulse-ring { animation: pulse-ring 2s cubic-bezier(0.4,0,0.6,1) infinite; }
    
    @keyframes ping {
      75%,to { transform: scale(2); opacity: 0; }
    }
    .animate-ping { animation: ping 1s cubic-bezier(0,0,0.2,1) infinite; }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .animate-spin { animation: spin 1s linear infinite; }
    
    @keyframes slide-left {
      0% { transform: translateX(10px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    .animate-slide-left { animation: slide-left 0.3s ease-out; }
    
    @keyframes fade-in {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    .animate-fade-in { animation: fade-in 0.3s ease-out; }
    
    .cursor-pointer { cursor: pointer; }
    .resize-none { resize: none; }
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
    .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
    .grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
    
    .flex-col { flex-direction: column; }
    .flex-wrap { flex-wrap: wrap; }
    .items-start { align-items: flex-start; }
    .items-center { align-items: center; }
    .items-stretch { align-items: stretch; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .justify-around { justify-content: space-around; }
    
    .gap-1 { gap: 0.25rem; }
    .gap-2 { gap: 0.5rem; }
    .gap-3 { gap: 0.75rem; }
    .gap-4 { gap: 1rem; }
    .gap-6 { gap: 1.5rem; }
    .gap-8 { gap: 2rem; }
    
    .space-y-1 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.25rem; }
    .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem; }
    .space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem; }
    .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
    .space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; }
    .space-y-8 > :not([hidden]) ~ :not([hidden]) { margin-top: 2rem; }
    .-space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-right: -0.5rem; }
    
    .overflow-hidden { overflow: hidden; }
    .overflow-y-auto { overflow-y: auto; }
    .overflow-x-auto { overflow-x: auto; }
    
    .rounded-full { border-radius: 9999px; }
    .rounded-lg { border-radius: var(--radius); }
    .rounded-xl { border-radius: var(--radius); }
    .rounded-2xl { border-radius: calc(var(--radius) + 2px); }
    .rounded-sm { border-radius: calc(var(--radius) - 4px); }
    
    .border { border-width: 1px; }
    .border-2 { border-width: 2px; }
    .border-4 { border-width: 4px; }
    .border-t { border-top-width: 1px; }
    .border-b { border-bottom-width: 1px; }
    .border-l { border-left-width: 1px; }
    .border-r { border-right-width: 1px; }
    .border-y { border-top-width: 1px; border-bottom-width: 1px; }
    
    .border-border { border-color: hsl(var(--border)); }
    .border-primary { border-color: hsl(var(--primary)); }
    .border-primary\/20 { border-color: hsl(var(--primary) / 0.2); }
    .border-success\/20 { border-color: hsl(var(--success) / 0.2); }
    .border-warning\/20 { border-color: hsl(var(--warning) / 0.2); }
    .border-destructive\/20 { border-color: hsl(var(--destructive) / 0.2); }
    .border-transparent { border-color: transparent; }
    
    .bg-background { background-color: hsl(var(--background)); }
    .bg-foreground { background-color: hsl(var(--foreground)); }
    .bg-primary { background-color: hsl(var(--primary)); }
    .bg-primary\/10 { background-color: hsl(var(--primary) / 0.1); }
    .bg-primary\/20 { background-color: hsl(var(--primary) / 0.2); }
    .bg-secondary { background-color: hsl(var(--secondary)); }
    .bg-muted { background-color: hsl(var(--muted)); }
    .bg-muted\/30 { background-color: hsl(var(--muted) / 0.3); }
    .bg-muted\/50 { background-color: hsl(var(--muted) / 0.5); }
    .bg-destructive { background-color: hsl(var(--destructive)); }
    .bg-success { background-color: hsl(var(--success)); }
    .bg-warning { background-color: hsl(var(--warning)); }
    .bg-warning\/10 { background-color: hsl(var(--warning) / 0.1); }
    .bg-black\/50 { background-color: rgba(0, 0, 0, 0.5); }
    .bg-white\/70 { background-color: rgba(255, 255, 255, 0.7); }
    
    .bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
    .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
    .from-primary { --tw-gradient-from: hsl(var(--primary)); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to); }
    .to-accent { --tw-gradient-to: hsl(var(--accent)); }
    .from-primary\/10 { --tw-gradient-from: hsl(var(--primary) / 0.1); }
    .to-accent\/10 { --tw-gradient-to: hsl(var(--accent) / 0.1); }
    .from-amber-500\/10 { --tw-gradient-from: rgb(245 158 11 / 0.1); }
    .to-rose-500\/10 { --tw-gradient-to: rgb(244 63 94 / 0.1); }
    .from-blue-400 { --tw-gradient-from: #60a5fa; }
    .to-purple-500 { --tw-gradient-to: #a855f7; }
    .from-green-400 { --tw-gradient-from: #4ade80; }
    .to-teal-500 { --tw-gradient-to: #14b8a6; }
    
    .bg-clip-text { -webkit-background-clip: text; background-clip: text; }
    
    .object-cover { object-fit: cover; }
    
    .p-1 { padding: 0.25rem; }
    .p-2 { padding: 0.5rem; }
    .p-3 { padding: 0.75rem; }
    .p-4 { padding: 1rem; }
    .p-6 { padding: 1.5rem; }
    .p-8 { padding: 2rem; }
    
    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
    .py-1\.5 { padding-top: 0.375rem; padding-bottom: 0.375rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
    .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
    
    .pt-2 { padding-top: 0.5rem; }
    .pt-3 { padding-top: 0.75rem; }
    .pt-4 { padding-top: 1rem; }
    .pt-8 { padding-top: 2rem; }
    .pt-24 { padding-top: 6rem; }
    .pb-6 { padding-bottom: 1.5rem; }
    .pb-8 { padding-bottom: 2rem; }
    .pl-12 { padding-left: 3rem; }
    
    .text-left { text-align: left; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    
    .font-sans { font-family: var(--font-inter), system-ui, sans-serif; }
    .font-display { font-family: var(--font-space-grotesk), var(--font-inter), sans-serif; }
    
    .text-xs { font-size: 0.75rem; line-height: 1rem; }
    .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
    .text-base { font-size: 1rem; line-height: 1.5rem; }
    .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
    .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
    .text-2xl { font-size: 1.5rem; line-height: 2rem; }
    .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
    .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
    
    .font-medium { font-weight: 500; }
    .font-semibold { font-weight: 600; }
    .font-bold { font-weight: 700; }
    .font-black { font-weight: 800; }
    
    .uppercase { text-transform: uppercase; }
    .capitalize { text-transform: capitalize; }
    
    .leading-tight { line-height: 1.25; }
    
    .text-foreground { color: hsl(var(--foreground)); }
    .text-primary { color: hsl(var(--primary)); }
    .text-primary-foreground { color: hsl(var(--primary-foreground)); }
    .text-secondary-foreground { color: hsl(var(--secondary-foreground)); }
    .text-muted-foreground { color: hsl(var(--muted-foreground)); }
    .text-accent { color: hsl(var(--accent)); }
    .text-success { color: hsl(var(--success)); }
    .text-warning { color: hsl(var(--warning)); }
    .text-destructive { color: hsl(var(--destructive)); }
    .text-amber-600 { color: #d97706; }
    .text-white { color: #fff; }
    .text-transparent { color: transparent; }
    
    .underline { text-decoration-line: underline; }
    
    .opacity-10 { opacity: 0.1; }
    .opacity-25 { opacity: 0.25; }
    .opacity-50 { opacity: 0.5; }
    .opacity-75 { opacity: 0.75; }
    
    .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
    .shadow-xl { box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); }
    .shadow-primary\/30 { box-shadow: 0 10px 15px -3px hsl(var(--primary) / 0.3); }
    
    .ring-1 { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000); }
    .ring-border { --tw-ring-color: hsl(var(--border)); }
    
    .blur { --tw-blur: blur(8px); filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow); }
    .backdrop-blur-xl { --tw-backdrop-blur: blur(24px); backdrop-filter: var(--tw-backdrop-blur); }
    .backdrop-blur-sm { --tw-backdrop-blur: blur(4px); backdrop-filter: var(--tw-backdrop-blur); }
    
    .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-colors { transition-property: color, background-color, border-color, text-decoration-color, fill, stroke; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .transition-transform { transition-property: transform; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
    .duration-300 { transition-duration: 300ms; }
    .duration-500 { transition-duration: 500ms; }
    .ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }
    
    /* Custom Components */
    .glass-card {
      background: hsl(var(--background) / 0.7);
      backdrop-filter: blur(12px);
      border: 1px solid hsl(var(--border) / 0.2);
      box-shadow: 0 8px 32px hsl(var(--foreground) / 0.04);
      border-radius: var(--radius);
      transition: all 0.3s;
    }
    .glass-card:hover {
      box-shadow: 0 16px 48px hsl(var(--foreground) / 0.08);
      border-color: hsl(var(--primary) / 0.3);
    }
    
    .dark .glass-card {
      background: hsl(222 47% 11% / 0.7);
      border-color: hsl(255 255% 255% / 0.05);
    }
    
    .gradient-text {
      background: linear-gradient(to right, hsl(var(--primary)), hsl(var(--accent)));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    .live-indicator {
      position: relative;
      display: flex;
      height: 0.75rem;
      width: 0.75rem;
    }
    .live-indicator span {
      position: absolute;
      display: inline-flex;
      height: 100%;
      width: 100%;
      border-radius: 9999px;
      background: hsl(var(--destructive));
      opacity: 0.75;
      animation: pulse-ring 2s infinite;
    }
    .live-indicator .dot {
      position: relative;
      display: inline-flex;
      border-radius: 9999px;
      height: 0.75rem;
      width: 0.75rem;
      background: hsl(var(--destructive));
    }
    
    .shoutout-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background: hsl(var(--primary) / 0.1);
      color: hsl(var(--primary));
      transition: all 0.3s;
    }
    .shoutout-btn.active {
      background: linear-gradient(to right, hsl(var(--primary)), hsl(var(--accent)));
      color: white;
    }
    
    .donation-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background: linear-gradient(to right, rgb(245 158 11 / 0.1), rgb(244 63 94 / 0.1));
      color: #d97706;
      transition: all 0.3s;
    }
    .dark .donation-btn { color: #fbbf24; }
    
    .difficulty-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .difficulty-badge.beginner {
      background: hsl(var(--success) / 0.1);
      color: hsl(var(--success));
      border: 1px solid hsl(var(--success) / 0.2);
    }
    .difficulty-badge.intermediate {
      background: hsl(var(--warning) / 0.1);
      color: hsl(var(--warning));
      border: 1px solid hsl(var(--warning) / 0.2);
    }
    .difficulty-badge.advanced {
      background: hsl(var(--destructive) / 0.1);
      color: hsl(var(--destructive));
      border: 1px solid hsl(var(--destructive) / 0.2);
    }
    
    .country-flag {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
      background: hsl(var(--muted) / 0.3);
      font-size: 0.75rem;
    }
    
    .reputation-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
      background: hsl(var(--warning) / 0.1);
      color: hsl(var(--warning));
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .verification-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 1.25rem;
      height: 1.25rem;
      border-radius: 9999px;
      background: hsl(var(--primary));
      color: white;
      box-shadow: 0 4px 6px -1px hsl(var(--primary) / 0.3);
    }
    
    .avatar-status {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 0.875rem;
      height: 0.875rem;
      border-radius: 9999px;
      border: 2px solid hsl(var(--background));
    }
    .avatar-status.online { background: hsl(var(--success)); }
    .avatar-status.away { background: hsl(var(--warning)); }
    .avatar-status.offline { background: hsl(var(--muted-foreground)); }
    
    .quick-join-btn {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      background: linear-gradient(to right, hsl(var(--primary)), hsl(var(--accent)));
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 6px -1px hsl(var(--primary) / 0.3);
      transition: all 0.3s;
    }
    .quick-join-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 12px -2px hsl(var(--primary) / 0.4);
    }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: hsl(var(--muted) / 0.3); }
    ::-webkit-scrollbar-thumb { background: hsl(var(--muted-foreground) / 0.3); border-radius: 9999px; }
    ::-webkit-scrollbar-thumb:hover { background: hsl(var(--muted-foreground) / 0.5); }
    
    /* Media Queries */
    @media (min-width: 640px) {
      .sm\:block { display: block; }
      .sm\:flex-row { flex-direction: row; }
      .sm\:items-end { align-items: flex-end; }
      .sm\:mt-0 { margin-top: 0; }
      .sm\:ml-6 { margin-left: 1.5rem; }
      .sm\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
    }
    
    @media (min-width: 768px) {
      .md\:flex { display: flex; }
      .md\:hidden { display: none; }
    }
    
    @media (min-width: 1024px) {
      .lg\:col-span-1 { grid-column: span 1 / span 1; }
      .lg\:col-span-2 { grid-column: span 2 / span 2; }
      .lg\:col-span-3 { grid-column: span 3 / span 3; }
      .lg\:col-span-6 { grid-column: span 6 / span 6; }
      .lg\:col-span-9 { grid-column: span 9 / span 9; }
      .lg\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0, 1fr)); }
      .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .lg\:block { display: block; }
    }
    
    @media (min-width: 1280px) {
      .xl\:col-span-3 { grid-column: span 3 / span 3; }
      .xl\:col-span-6 { grid-column: span 6 / span 6; }
      .xl\:block { display: block; }
      .xl\:grid-cols-8 { grid-template-columns: repeat(8, minmax(0, 1fr)); }
    }
  </style>
</head>
<body id="app-body" class="font-sans antialiased bg-background text-foreground">
  <div id="theme-root" class="min-h-screen">
    <!-- ============ TOP NAVIGATION ============ -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-xl border-b border-border transition-all">
      <nav class="max-w-[1440px] mx-auto px-4 h-16 flex items-center justify-between">
        <!-- Logo -->
        <div class="flex items-center gap-2 cursor-pointer" id="logo-home">
          <div class="transition-all hover:scale-110 hover:rotate-12 duration-300">
            <svg class="w-8 h-8 text-primary" fill="currentColor" viewBox="0 0 24 24">
              <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
            </svg>
          </div>
          <span class="font-display font-bold text-xl gradient-text hidden sm:block">ThumbsApp</span>
        </div>
        
        <!-- Desktop Nav Links -->
        <div class="hidden md:flex items-center gap-1">
          <a href="/" class="flex items-center gap-2 px-4 py-2 rounded-xl hover:bg-muted transition-colors text-primary bg-primary/10">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            <span class="font-medium">Home</span>
          </a>
          <a href="/explore" class="flex items-center gap-2 px-4 py-2 rounded-xl hover:bg-muted transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
            <span class="font-medium">Explore</span>
          </a>
          <a href="/arena" class="flex items-center gap-2 px-4 py-2 rounded-xl hover:bg-muted transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="font-medium">Arena</span>
          </a>
        </div>
        
        <!-- Right Icons -->
        <div class="flex items-center gap-3">
          <!-- Search (mobile) -->
          <button class="md:hidden p-2 rounded-full hover:bg-muted transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </button>
          
          <!-- Notification Bell -->
          <div class="relative">
            <button id="notif-bell" class="p-2 rounded-full hover:bg-muted transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
              </svg>
            </button>
            <span id="notif-badge" class="absolute -top-1 -right-1 bg-destructive text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
          </div>
          
          <!-- Theme Toggle -->
          <button id="theme-toggle" class="p-2 rounded-full hover:bg-muted transition-colors">
            <svg id="theme-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
          </button>
          
          <!-- Profile Avatar / Login Button -->
          <div class="relative auth-required" style="display: none;">
            <button id="profile-btn" class="flex items-center gap-2 p-1 rounded-full border-2 border-transparent hover:border-primary transition-colors">
              <div class="relative w-8 h-8 rounded-full overflow-hidden bg-gradient-to-r from-primary to-accent flex items-center justify-center text-white user-avatar">
                <span class="font-bold text-sm">U</span>
              </div>
            </button>
          </div>
          
          <div class="guest-only flex items-center gap-2">
            <a href="/login" class="px-4 py-2 rounded-xl bg-primary/10 text-primary font-medium hover:bg-primary/20 transition-colors">Login</a>
            <a href="/register" class="px-4 py-2 rounded-xl bg-gradient-to-r from-primary to-accent text-white font-medium shadow-lg">Sign Up</a>
          </div>
        </div>
      </nav>
      
      <!-- Mobile Bottom Nav -->
      <div class="md:hidden fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-xl border-t border-border">
        <div class="flex items-center justify-around py-2">
          <a href="/" class="flex flex-col items-center p-2 text-primary">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            <span class="text-xs mt-1">Home</span>
          </a>
          <a href="/explore" class="flex flex-col items-center p-2 text-muted-foreground">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
            <span class="text-xs mt-1">Explore</span>
          </a>
          <a href="/arena" class="flex flex-col items-center p-2 text-muted-foreground">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="text-xs mt-1">Arena</span>
          </a>
          <a href="/profile" class="flex flex-col items-center p-2 text-muted-foreground auth-required" style="display: none;">
            <div class="w-6 h-6 rounded-full bg-gradient-to-r from-primary to-accent flex items-center justify-center text-white text-xs user-avatar-mobile">U</div>
            <span class="text-xs mt-1">Profile</span>
          </a>
        </div>
      </div>
    </header>

    <!-- ============ MAIN CONTENT ============ -->
    <div class="max-w-[1440px] mx-auto px-4 pt-24 pb-8">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- ============ LEFT COLUMN (PROFILE/DISCOVERY) ============ -->
        <aside class="lg:col-span-3 xl:col-span-3 hidden lg:block">
          <div class="sticky top-24 space-y-6">
            <!-- Identity Card (shows when logged in) -->
            <div class="glass-card p-6 animate-fade-in auth-required" style="display: none;">
              <div class="flex items-start gap-4">
                <div class="relative">
                  <div class="w-16 h-16 rounded-full overflow-hidden bg-gradient-to-br from-primary to-accent flex items-center justify-center text-white text-xl font-bold user-avatar">
                    U
                  </div>
                  <span class="avatar-status online user-status"></span>
                  <span class="absolute -bottom-1 -right-1 verification-badge user-verified" style="display: none;">
                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                    </svg>
                  </span>
                </div>
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-1">
                    <h3 class="font-display font-semibold text-lg user-display-name">Guest User</h3>
                  </div>
                  <div class="flex items-center gap-3 mb-3 text-sm">
                    <span class="flex items-center gap-1 text-muted-foreground">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                      </svg>
                      <span class="user-country">US</span>
                    </span>
                    <span class="reputation-badge">
                      <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                      </svg>
                      <span class="user-reputation">4.50</span>
                    </span>
                  </div>
                  <div class="grid grid-cols-3 gap-2 text-center">
                    <div>
                      <p class="font-bold text-lg user-charts-created">0</p>
                      <p class="text-xs text-muted-foreground">Charts</p>
                    </div>
                    <div>
                      <p class="font-bold text-lg user-followers">0</p>
                      <p class="text-xs text-muted-foreground">Followers</p>
                    </div>
                    <div>
                      <p class="font-bold text-lg user-following">0</p>
                      <p class="text-xs text-muted-foreground">Following</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mt-4 flex gap-2">
                <button class="glass-card px-3 py-1.5 text-sm rounded-xl flex-1 flex items-center justify-center gap-1" onclick="app.openCreateChartModal()">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Create
                </button>
                <button class="glass-card px-3 py-1.5 text-sm rounded-xl flex-1 flex items-center justify-center gap-1" onclick="window.location.href='/balance'">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  <span class="user-balance">0</span>
                </button>
              </div>
            </div>
            
            <!-- Guest Card (shown when not logged in) -->
            <div class="glass-card p-6 animate-fade-in guest-only">
              <div class="text-center">
                <div class="w-20 h-20 mx-auto rounded-full bg-gradient-to-r from-primary to-accent flex items-center justify-center text-white text-3xl font-bold mb-4">
                  ðŸ‘‹
                </div>
                <h3 class="font-display font-semibold text-lg mb-2">Welcome to ThumbsApp!</h3>
                <p class="text-sm text-muted-foreground mb-4">Join the community to create charts, compete, and earn rewards.</p>
                <div class="flex gap-2">
                  <a href="/login" class="flex-1 px-4 py-2 rounded-xl bg-primary/10 text-primary font-medium hover:bg-primary/20 transition-colors">Login</a>
                  <a href="/register" class="flex-1 px-4 py-2 rounded-xl bg-gradient-to-r from-primary to-accent text-white font-medium shadow-lg">Sign Up</a>
                </div>
              </div>
            </div>
            
            <!-- Discovery Panel -->
            <div class="glass-card p-6">
              <h4 class="font-display font-semibold mb-4 flex items-center">
                <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Discovery
              </h4>
              <nav class="space-y-2">
                <a href="/trending" class="flex items-center gap-3 p-3 rounded-xl hover:bg-muted transition-colors group">
                  <span class="text-primary group-hover:scale-110 transition-transform">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M13 5.5v6h5l-6 7v-6h-5l6-7z"/>
                    </svg>
                  </span>
                  <span class="flex-1 font-medium">Trending Charts</span>
                  <span class="bg-primary/10 text-primary text-xs px-2 py-0.5 rounded-full trending-count">234</span>
                </a>
                <a href="/players" class="flex items-center gap-3 p-3 rounded-xl hover:bg-muted transition-colors group">
                  <span class="text-warning group-hover:scale-110">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M5 3h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2zm12 4h-2v2h2V7zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zM7 7h2v2H7V7zm0 4h2v2H7v-2zm0 4h2v2H7v-2z"/>
                    </svg>
                  </span>
                  <span class="flex-1 font-medium">Top Players</span>
                </a>
                <a href="/new" class="flex items-center gap-3 p-3 rounded-xl hover:bg-muted">
                  <span class="text-success">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-.5-13v6l5.25 3.15.75-1.23-4.5-2.67V7z"/>
                    </svg>
                  </span>
                  <span class="flex-1 font-medium">New Games</span>
                  <span class="bg-success/10 text-success text-xs px-2 py-0.5 new-games-badge">+12</span>
                </a>
              </nav>
            </div>
            
            <!-- Support Pool Preview -->
            <div class="glass-card p-6 bg-gradient-to-br from-primary/5 to-accent/5">
              <div class="flex items-center gap-3 mb-2">
                <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                <h4 class="font-semibold">Support Pool</h4>
              </div>
              <p class="text-sm text-muted-foreground">Back players & tournaments</p>
              <div class="mt-3 flex items-center justify-between">
                <span class="text-xs">Total backed</span>
                <span class="font-bold text-primary total-backed">2,560 THB</span>
              </div>
              <button class="w-full mt-4 px-4 py-2 rounded-xl bg-primary/10 text-primary font-medium hover:bg-primary/20 transition-colors" onclick="window.location.href='/support'">
                Support Now
              </button>
            </div>
            
            <!-- Leaderboard Preview -->
            <div class="glass-card p-6">
              <div class="flex items-center justify-between mb-4">
                <h4 class="font-display font-semibold flex items-center gap-2">
                  <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                  Leaderboard
                </h4>
                <a href="/leaderboard" class="text-xs text-primary hover:underline">View All</a>
              </div>
              <div class="space-y-3 leaderboard-preview">
                <!-- Will be populated by JS -->
                <div class="flex items-center gap-3 py-2">
                  <div class="w-6 text-sm font-semibold text-muted-foreground">1.</div>
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-accent"></div>
                  <div class="flex-1">
                    <div class="h-4 bg-muted rounded w-24"></div>
                  </div>
                </div>
                <div class="flex items-center gap-3 py-2">
                  <div class="w-6 text-sm font-semibold text-muted-foreground">2.</div>
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-accent"></div>
                  <div class="flex-1">
                    <div class="h-4 bg-muted rounded w-20"></div>
                  </div>
                </div>
                <div class="flex items-center gap-3 py-2">
                  <div class="w-6 text-sm font-semibold text-muted-foreground">3.</div>
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-accent"></div>
                  <div class="flex-1">
                    <div class="h-4 bg-muted rounded w-16"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </aside>

        <!-- ============ CENTER COLUMN - CHARTS FEED ============ -->
        <main class="lg:col-span-9 xl:col-span-6">
          <div class="space-y-4 charts-feed">
            <!-- Quick Create Chart Card (shown when logged in) -->
            <div class="glass-card p-4 flex items-center gap-3 auth-required" style="display: none;">
              <div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
              </div>
              <input type="text" id="quick-chart-input" placeholder="Create a new challenge..." class="flex-1 bg-transparent border-none focus:outline-none text-foreground placeholder-muted-foreground">
              <button class="px-4 py-2 rounded-full bg-gradient-to-r from-primary to-accent text-white text-sm font-medium shadow-lg" onclick="app.openCreateChartModal()">
                Post
              </button>
            </div>
            
            <!-- Feed Filters -->
            <div class="flex items-center gap-2 overflow-x-auto py-2">
              <button class="px-4 py-2 rounded-full bg-primary text-white text-sm font-medium filter-btn active" data-filter="all">All</button>
              <button class="px-4 py-2 rounded-full bg-muted text-muted-foreground hover:bg-primary/10 text-sm font-medium filter-btn" data-filter="trending">Trending</button>
              <button class="px-4 py-2 rounded-full bg-muted text-muted-foreground hover:bg-primary/10 text-sm font-medium filter-btn" data-filter="beginner">Beginner</button>
              <button class="px-4 py-2 rounded-full bg-muted text-muted-foreground hover:bg-primary/10 text-sm font-medium filter-btn" data-filter="intermediate">Intermediate</button>
              <button class="px-4 py-2 rounded-full bg-muted text-muted-foreground hover:bg-primary/10 text-sm font-medium filter-btn" data-filter="advanced">Advanced</button>
              <button class="px-4 py-2 rounded-full bg-muted text-muted-foreground hover:bg-primary/10 text-sm font-medium filter-btn" data-filter="prize">High Prize</button>
            </div>
            
            <!-- Chart Cards Will Be Injected Here -->
            <div class="text-center py-8 text-muted-foreground loading-feed">
              <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent mb-4"></div>
              <p>Loading challenges...</p>
            </div>
          </div>
          
          <!-- Load More -->
          <div class="py-6 text-center">
            <button class="px-6 py-3 rounded-xl bg-muted text-muted-foreground hover:bg-primary/10 transition-colors load-more-btn" onclick="app.loadMoreCharts()">
              Load More
            </button>
          </div>
        </main>

        <!-- ============ RIGHT COLUMN - LIVE ARENAS ============ -->
        <aside class="xl:col-span-3 hidden xl:block">
          <div class="sticky top-24 space-y-6">
            <!-- Live Arenas Header -->
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div class="live-indicator">
                  <span></span>
                  <span class="dot"></span>
                </div>
                <h3 class="font-display font-semibold">Live Arenas</h3>
              </div>
              <span class="text-sm text-muted-foreground flex items-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
                <span class="live-viewers">2.3k</span>
              </span>
            </div>
            
            <!-- Live Arenas Container -->
            <div class="space-y-4 live-arenas">
              <!-- Will be populated by JS -->
              <div class="glass-card p-4 text-center text-muted-foreground">
                <div class="animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent mx-auto mb-2"></div>
                <p class="text-sm">Loading arenas...</p>
              </div>
            </div>
            
            <!-- Quick Join Card -->
            <div class="glass-card p-6 bg-gradient-to-br from-primary/5 to-accent/5">
              <div class="flex items-center gap-4 mb-4">
                <div class="p-3 rounded-2xl bg-primary/10 text-primary">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                </div>
                <div>
                  <h4 class="font-display font-semibold mb-1">Ready to Compete?</h4>
                  <p class="text-xs text-muted-foreground">Join an arena and showcase skills</p>
                </div>
              </div>
              <div class="flex items-center justify-between mb-4 text-sm">
                <div>
                  <p class="font-bold text-lg open-arenas-count">24</p>
                  <p class="text-xs text-muted-foreground">Open arenas</p>
                </div>
                <div>
                  <p class="font-bold text-lg players-waiting">156</p>
                  <p class="text-xs text-muted-foreground">Players waiting</p>
                </div>
              </div>
              <button class="quick-join-btn" onclick="app.quickJoinMatch()">
                Quick Join Match
              </button>
            </div>
            
            <!-- Top Supporters -->
            <div class="glass-card p-6">
              <h4 class="font-display font-semibold mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                Top Supporters
              </h4>
              <div class="space-y-3 top-supporters">
                <!-- Will be populated by JS -->
                <div class="flex items-center gap-3">
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-accent"></div>
                  <div class="flex-1">
                    <div class="h-4 bg-muted rounded w-20"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <!-- ============ DONATION MODAL ============ -->
    <div id="donationModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
      <div class="glass-card max-w-md w-full p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-display font-bold text-xl gradient-text">Support Challenge</h3>
          <button class="p-2 rounded-full hover:bg-muted transition-colors" onclick="app.closeDonationModal()">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <div class="space-y-4">
          <div>
            <label class="text-sm font-medium mb-2 block">Amount (THB)</label>
            <div class="grid grid-cols-5 gap-2 mt-2">
              <button class="preset-amount py-2 border rounded-lg hover:bg-primary/10 transition-colors" data-amount="10">10</button>
              <button class="preset-amount py-2 border rounded-lg bg-primary/10 border-primary" data-amount="25">25</button>
              <button class="preset-amount py-2 border rounded-lg" data-amount="50">50</button>
              <button class="preset-amount py-2 border rounded-lg" data-amount="100">100</button>
              <button class="preset-amount py-2 border rounded-lg" data-amount="250">250</button>
            </div>
          </div>
          
          <input type="number" id="custom-amount" placeholder="Custom amount" class="w-full px-4 py-2 rounded-lg border border-border bg-background">
          
          <textarea id="donation-message" rows="2" placeholder="Message (optional)" class="w-full px-4 py-2 rounded-lg border border-border bg-background resize-none"></textarea>
          
          <div class="bg-primary/10 rounded-lg p-3">
            <div class="flex items-center justify-between text-sm">
              <span>Donating to:</span>
              <span class="font-semibold donation-recipient">Sarah Chen</span>
            </div>
            <div class="flex items-center justify-between text-sm mt-1">
              <span>Your balance:</span>
              <span class="font-semibold user-balance-modal">2,500 THB</span>
            </div>
          </div>
          
          <div class="flex gap-3">
            <button id="cancelDonation" class="flex-1 border border-border px-4 py-2 rounded-xl hover:bg-muted transition-colors" onclick="app.closeDonationModal()">
              Cancel
            </button>
            <button id="confirmDonation" class="flex-1 bg-gradient-to-r from-primary to-accent text-white px-4 py-2 rounded-xl font-semibold shadow-lg" onclick="app.processDonation()">
              Donate 25 THB
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ TOAST CONTAINER ============ -->
    <div id="toast-container" class="fixed top-20 right-4 z-50 space-y-2"></div>
  </div>

  <!-- ============ API CLIENT ============ -->
  <script>
    // ThumbsApp API Client
    const API_URL = window.location.hostname === 'localhost' 
      ? 'http://localhost:5000/api' 
      : '/api';

    const WS_URL = window.location.hostname === 'localhost'
      ? 'ws://localhost:5000/ws'
      : 'wss://' + window.location.host + '/ws';

    class ThumbsAppAPI {
      constructor() {
        this.token = localStorage.getItem('thumbsapp_token');
        this.user = null;
        this.ws = null;
        this.wsCallbacks = new Map();
        this.reconnectAttempts = 0;
        this.maxReconnectAttempts = 5;
      }

      setToken(token) {
        this.token = token;
        localStorage.setItem('thumbsapp_token', token);
      }

      clearToken() {
        this.token = null;
        this.user = null;
        localStorage.removeItem('thumbsapp_token');
      }

      getHeaders(includeAuth = true) {
        const headers = { 'Content-Type': 'application/json' };
        if (includeAuth && this.token) {
          headers['Authorization'] = `Bearer ${this.token}`;
        }
        return headers;
      }

      async handleResponse(response) {
        const data = await response.json();
        if (!response.ok) {
          if (response.status === 401 || response.status === 403) {
            this.clearToken();
            window.location.href = '/login';
          }
          throw new Error(data.error || 'Request failed');
        }
        return data;
      }

      // ============ AUTH ============
      async register(userData) {
        const response = await fetch(`${API_URL}/auth/register`, {
          method: 'POST',
          headers: this.getHeaders(false),
          body: JSON.stringify(userData)
        });
        const data = await this.handleResponse(response);
        if (data.token) this.setToken(data.token);
        return data;
      }

      async login(credentials) {
        const response = await fetch(`${API_URL}/auth/login`, {
          method: 'POST',
          headers: this.getHeaders(false),
          body: JSON.stringify(credentials)
        });
        const data = await this.handleResponse(response);
        if (data.token) {
          this.setToken(data.token);
          this.user = data.user;
        }
        return data;
      }

      async logout() {
        if (this.token) {
          try {
            await fetch(`${API_URL}/auth/logout`, {
              method: 'POST',
              headers: this.getHeaders()
            });
          } catch (e) {}
        }
        this.clearToken();
        if (this.ws) this.ws.close();
      }

      async getCurrentUser() {
        const response = await fetch(`${API_URL}/auth/me`, {
          headers: this.getHeaders()
        });
        const data = await this.handleResponse(response);
        this.user = data;
        return data;
      }

      // ============ USERS ============
      async getUserProfile(userId) {
        const response = await fetch(`${API_URL}/users/${userId}`);
        return this.handleResponse(response);
      }

      async updateProfile(formData) {
        const response = await fetch(`${API_URL}/users/profile`, {
          method: 'PUT',
          headers: { 'Authorization': `Bearer ${this.token}` },
          body: formData
        });
        return this.handleResponse(response);
      }

      async followUser(userId) {
        const response = await fetch(`${API_URL}/users/${userId}/follow`, {
          method: 'POST',
          headers: this.getHeaders()
        });
        return this.handleResponse(response);
      }

      // ============ CHARTS ============
      async createChart(chartData) {
        const response = await fetch(`${API_URL}/charts`, {
          method: 'POST',
          headers: this.getHeaders(),
          body: JSON.stringify(chartData)
        });
        return this.handleResponse(response);
      }

      async getFeed(params = {}) {
        const query = new URLSearchParams(params).toString();
        const response = await fetch(`${API_URL}/charts/feed?${query}`);
        return this.handleResponse(response);
      }

      async getChart(chartId) {
        const response = await fetch(`${API_URL}/charts/${chartId}`);
        return this.handleResponse(response);
      }

      async joinChart(chartId) {
        const response = await fetch(`${API_URL}/charts/${chartId}/join`, {
          method: 'POST',
          headers: this.getHeaders()
        });
        return this.handleResponse(response);
      }

      // ============ SHOUTOUTS ============
      async createShoutout(data) {
        const response = await fetch(`${API_URL}/shoutouts`, {
          method: 'POST',
          headers: this.getHeaders(),
          body: JSON.stringify(data)
        });
        return this.handleResponse(response);
      }

      async getChartShoutouts(chartId) {
        const response = await fetch(`${API_URL}/shoutouts/chart/${chartId}`);
        return this.handleResponse(response);
      }

      // ============ DONATIONS ============
      async createDonation(data) {
        const response = await fetch(`${API_URL}/donations`, {
          method: 'POST',
          headers: this.getHeaders(),
          body: JSON.stringify(data)
        });
        return this.handleResponse(response);
      }

      // ============ ARENAS ============
      async getLiveArenas() {
        const response = await fetch(`${API_URL}/arenas/live`);
        return this.handleResponse(response);
      }

      async getArena(arenaId) {
        const response = await fetch(`${API_URL}/arenas/${arenaId}`);
        return this.handleResponse(response);
      }

      // ============ NOTIFICATIONS ============
      async getNotifications(page = 1) {
        const response = await fetch(`${API_URL}/notifications?page=${page}`, {
          headers: this.getHeaders()
        });
        return this.handleResponse(response);
      }

      // ============ TRANSACTIONS ============
      async deposit(amount) {
        const response = await fetch(`${API_URL}/transactions/deposit`, {
          method: 'POST',
          headers: this.getHeaders(),
          body: JSON.stringify({ amount })
        });
        return this.handleResponse(response);
      }

      // ============ LEADERBOARD ============
      async getLeaderboard(type = 'reputation', limit = 5) {
        const response = await fetch(`${API_URL}/leaderboard?type=${type}&limit=${limit}`);
        return this.handleResponse(response);
      }

      // ============ SEARCH ============
      async search(query, type = 'all') {
        const response = await fetch(`${API_URL}/search?q=${encodeURIComponent(query)}&type=${type}`);
        return this.handleResponse(response);
      }

      // ============ STATS ============
      async getStats() {
        const response = await fetch(`${API_URL}/stats`);
        return this.handleResponse(response);
      }

      // ============ WEBSOCKET ============
      connectWebSocket(callbacks = {}) {
        if (!this.token) return null;
        this.wsCallbacks = callbacks;
        
        try {
          this.ws = new WebSocket(WS_URL);
          
          this.ws.onopen = () => {
            this.reconnectAttempts = 0;
            this.ws.send(JSON.stringify({ type: 'auth', token: this.token }));
            if (callbacks.onOpen) callbacks.onOpen();
          };
          
          this.ws.onmessage = (event) => {
            try {
              const msg = JSON.parse(event.data);
              switch (msg.type) {
                case 'auth_success':
                  if (callbacks.onAuth) callbacks.onAuth(msg.userId);
                  break;
                case 'notification':
                  if (callbacks.onNotification) callbacks.onNotification(msg.notification);
                  break;
                case 'arena_state':
                  if (callbacks.onArenaState) callbacks.onArenaState(msg.arena);
                  break;
                case 'arena_chat':
                  if (callbacks.onArenaChat) callbacks.onArenaChat(msg.chat, msg.arenaId);
                  break;
                case 'score_update':
                  if (callbacks.onScoreUpdate) callbacks.onScoreUpdate(msg.playerId, msg.score, msg.moves, msg.arenaId);
                  break;
                case 'user_status':
                  if (callbacks.onUserStatus) callbacks.onUserStatus(msg.userId, msg.status);
                  break;
              }
            } catch (e) {}
          };
          
          this.ws.onclose = () => {
            if (this.reconnectAttempts < this.maxReconnectAttempts) {
              this.reconnectAttempts++;
              setTimeout(() => this.connectWebSocket(callbacks), 3000);
            }
            if (callbacks.onClose) callbacks.onClose();
          };
          
          return this.ws;
        } catch (e) {
          return null;
        }
      }

      // WebSocket actions
      joinArena(arenaId) {
        if (this.ws?.readyState === WebSocket.OPEN) {
          this.ws.send(JSON.stringify({ type: 'join_arena', arenaId }));
        }
      }

      sendArenaChat(arenaId, message) {
        if (this.ws?.readyState === WebSocket.OPEN) {
          this.ws.send(JSON.stringify({ type: 'arena_chat', arenaId, message }));
        }
      }

      // Utilities
      formatCurrency(amount) {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'THB', minimumFractionDigits: 0 }).format(amount);
      }

      formatNumber(num) {
        if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
        if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
        return num.toString();
      }

      formatDate(date) {
        const d = new Date(date);
        const now = new Date();
        const diff = now - d;
        if (diff < 60000) return 'Just now';
        if (diff < 3600000) return Math.floor(diff / 60000) + 'm ago';
        if (diff < 86400000) return Math.floor(diff / 3600000) + 'h ago';
        if (diff < 604800000) return Math.floor(diff / 86400000) + 'd ago';
        return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      }
    }

    // Create global instance
    window.thumbsAPI = new ThumbsAppAPI();
  </script>

  <!-- ============ MAIN APPLICATION ============ -->
  <script>
    class ThumbsApp {
      constructor() {
        this.api = window.thumbsAPI;
        this.initialized = false;
        this.currentFilter = 'all';
        this.currentPage = 1;
        this.hasMore = true;
      }

      async init() {
        if (this.initialized) return;
        
        // Check auth
        await this.checkAuth();
        
        // Setup event listeners
        this.setupEventListeners();
        
        // Load data
        await this.loadInitialData();
        
        // Setup WebSocket if logged in
        if (this.api.token) {
          this.setupWebSocket();
        }
        
        this.initialized = true;
      }

      async checkAuth() {
        if (this.api.token) {
          try {
            await this.api.getCurrentUser();
            this.updateUIForAuth(true);
          } catch (error) {
            this.api.clearToken();
            this.updateUIForAuth(false);
          }
        } else {
          this.updateUIForAuth(false);
        }
      }

      updateUIForAuth(isAuthenticated) {
        const authElements = document.querySelectorAll('.auth-required');
        const guestElements = document.querySelectorAll('.guest-only');
        
        authElements.forEach(el => el.style.display = isAuthenticated ? '' : 'none');
        guestElements.forEach(el => el.style.display = isAuthenticated ? 'none' : '');
        
        if (isAuthenticated && this.api.user) {
          this.updateUserProfileUI();
        }
      }

      updateUserProfileUI() {
        const user = this.api.user;
        if (!user) return;
        
        // Update display name
        document.querySelectorAll('.user-display-name').forEach(el => {
          el.textContent = user.displayName || user.username;
        });
        
        // Update avatar
        document.querySelectorAll('.user-avatar').forEach(el => {
          if (user.avatar) {
            el.innerHTML = `<img src="${user.avatar}" alt="${user.displayName}" class="w-full h-full object-cover">`;
          } else {
            const initial = (user.displayName || user.username).charAt(0).toUpperCase();
            el.innerHTML = `<span class="font-bold">${initial}</span>`;
          }
        });
        
        // Update stats
        document.querySelectorAll('.user-charts-created').forEach(el => {
          el.textContent = user.chartsCreated || 0;
        });
        
        document.querySelectorAll('.user-followers').forEach(el => {
          el.textContent = this.api.formatNumber(user.followers?.length || 0);
        });
        
        document.querySelectorAll('.user-following').forEach(el => {
          el.textContent = this.api.formatNumber(user.following?.length || 0);
        });
        
        document.querySelectorAll('.user-reputation').forEach(el => {
          el.textContent = (user.reputation || 4.5).toFixed(2);
        });
        
        document.querySelectorAll('.user-balance, .user-balance-modal').forEach(el => {
          el.textContent = this.api.formatCurrency(user.balance || 0);
        });
        
        document.querySelectorAll('.user-country').forEach(el => {
          el.textContent = user.country || 'US';
        });
        
        // Verification badge
        document.querySelectorAll('.user-verified').forEach(el => {
          el.style.display = user.isVerified ? 'flex' : 'none';
        });
        
        // Status
        document.querySelectorAll('.user-status').forEach(el => {
          el.className = `avatar-status ${user.status || 'online'}`;
        });
      }

      setupEventListeners() {
        // Theme toggle
        document.getElementById('theme-toggle')?.addEventListener('click', () => this.toggleTheme());
        
        // Logo home
        document.getElementById('logo-home')?.addEventListener('click', () => window.location.href = '/');
        
        // Notification bell
        document.getElementById('notif-bell')?.addEventListener('click', () => this.openNotifications());
        
        // Profile button
        document.getElementById('profile-btn')?.addEventListener('click', () => {
          if (this.api.user) {
            window.location.href = `/profile?id=${this.api.user.id}`;
          }
        });
        
        // Filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            document.querySelectorAll('.filter-btn').forEach(b => {
              b.classList.remove('bg-primary', 'text-white');
              b.classList.add('bg-muted', 'text-muted-foreground');
            });
            btn.classList.add('bg-primary', 'text-white');
            btn.classList.remove('bg-muted', 'text-muted-foreground');
            
            this.currentFilter = btn.dataset.filter;
            this.currentPage = 1;
            this.loadFeed(true);
          });
        });
        
        // Quick chart input
        const quickInput = document.getElementById('quick-chart-input');
        if (quickInput) {
          quickInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
              this.openCreateChartModal();
            }
          });
        }
      }

      toggleTheme() {
        const body = document.getElementById('app-body');
        const icon = document.getElementById('theme-icon');
        const isDark = body.classList.contains('dark');
        
        if (isDark) {
          body.classList.remove('dark');
          icon.setAttribute('d', 'M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z');
        } else {
          body.classList.add('dark');
          icon.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z');
        }
      }

      async loadInitialData() {
        try {
          await Promise.all([
            this.loadFeed(),
            this.loadLiveArenas(),
            this.loadLeaderboard(),
            this.loadStats()
          ]);
        } catch (error) {
          this.showToast('Error', 'Failed to load data', 'error');
        }
      }

      async loadFeed(reset = false) {
        const container = document.querySelector('.charts-feed');
        if (!container) return;
        
        try {
          if (reset) {
            container.innerHTML = '<div class="text-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent mx-auto"></div></div>';
          }
          
          const params = {
            page: this.currentPage,
            limit: 5,
            status: 'open'
          };
          
          if (this.currentFilter !== 'all') {
            if (['beginner', 'intermediate', 'advanced'].includes(this.currentFilter)) {
              params.difficulty = this.currentFilter;
            } else if (this.currentFilter === 'trending') {
              params.sort = 'popular';
            } else if (this.currentFilter === 'prize') {
              params.sort = 'prize';
            }
          }
          
          const data = await this.api.getFeed(params);
          this.hasMore = data.pagination.page < data.pagination.pages;
          
          if (reset) {
            this.renderFeed(data.charts);
          } else {
            this.appendFeed(data.charts);
          }
          
          // Update load more button
          const loadMoreBtn = document.querySelector('.load-more-btn');
          if (loadMoreBtn) {
            loadMoreBtn.style.display = this.hasMore ? 'block' : 'none';
          }
        } catch (error) {
          container.innerHTML = '<div class="text-center py-8 text-destructive">Failed to load charts</div>';
        }
      }

      renderFeed(charts) {
        const container = document.querySelector('.charts-feed');
        if (!container) return;
        
        if (!charts || charts.length === 0) {
          container.innerHTML = `
            <div class="glass-card p-8 text-center">
              <svg class="w-16 h-16 mx-auto text-muted-foreground mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
              </svg>
              <h3 class="text-xl font-semibold mb-2">No open charts</h3>
              <p class="text-muted-foreground mb-4">Be the first to create a challenge!</p>
              <button class="px-6 py-3 bg-gradient-to-r from-primary to-accent text-white rounded-xl font-semibold" onclick="app.openCreateChartModal()">
                Create Chart
              </button>
            </div>
          `;
          return;
        }
        
        container.innerHTML = charts.map(chart => this.renderChartCard(chart)).join('');
        this.attachChartEvents();
      }

      appendFeed(charts) {
        const container = document.querySelector('.charts-feed');
        if (!container) return;
        container.insertAdjacentHTML('beforeend', charts.map(chart => this.renderChartCard(chart)).join(''));
        this.attachChartEvents();
      }

      renderChartCard(chart) {
        const timeLeft = this.getTimeLeft(chart.startsAt);
        const spotsLeft = chart.maxParticipants - (chart.participants?.length || 1);
        
        return `
          <div class="glass-card p-6 hover:shadow-xl transition-all chart-card" data-chart-id="${chart._id}">
            <div class="flex items-start justify-between mb-4">
              <div class="flex items-center gap-3">
                <div class="relative">
                  <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold">
                    ${chart.creator?.displayName?.charAt(0) || 'U'}
                  </div>
                  ${chart.creator?.status === 'online' ? '<span class="avatar-status online"></span>' : ''}
                  ${chart.creator?.isVerified ? '<span class="absolute -bottom-1 -right-1 verification-badge w-4 h-4 text-[10px]">âœ“</span>' : ''}
                </div>
                <div>
                  <div class="flex items-center gap-2 mb-1">
                    <h4 class="font-semibold">${chart.creator?.displayName || 'Unknown'}</h4>
                    <span class="country-flag">
                      <img src="https://flagcdn.com/w20/${(chart.creator?.country || 'US').toLowerCase()}.png" width="16" height="12" class="rounded-sm" onerror="this.src='https://flagcdn.com/w20/us.png'">
                      <span>${chart.creator?.country || 'US'}</span>
                    </span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="reputation-badge">
                      <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                      </svg>
                      ${(chart.creator?.reputation || 4.5).toFixed(2)}
                    </span>
                  </div>
                </div>
              </div>
              <span class="difficulty-badge ${chart.difficulty}">
                ${chart.difficulty?.charAt(0).toUpperCase() + chart.difficulty?.slice(1) || 'Intermediate'}
              </span>
            </div>
            
            <h3 class="font-display font-bold text-xl mb-2">${chart.title}</h3>
            <p class="text-sm text-muted-foreground mb-3 line-clamp-2">${chart.description || 'No description'}</p>
            
            <div class="flex items-center gap-4 mb-3 text-sm flex-wrap">
              <span class="flex items-center gap-1 text-muted-foreground">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${chart.game || 'Game'}
              </span>
              <span class="flex items-center gap-1 text-success font-semibold">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${this.api.formatCurrency(chart.entryFee)}
              </span>
              <span class="flex items-center gap-1 text-primary">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/>
                </svg>
                Prize: ${this.api.formatCurrency(chart.prizePool || chart.prize || chart.entryFee * 2)}
              </span>
            </div>
            
            ${chart.prizeItem ? `
              <div class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-primary/10 text-primary text-sm mb-3">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/>
                </svg>
                <span class="font-medium">Gift:</span> ${chart.prizeItem.name}
              </div>
            ` : ''}
            
            <div class="bg-primary/10 border border-primary/20 rounded-xl p-3 flex items-center justify-between mb-4">
              <div class="flex items-center gap-2">
                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                </svg>
                <span class="font-medium text-sm">Locked Entry</span>
              </div>
              <span class="font-semibold text-primary">${this.api.formatCurrency(chart.entryFee)}</span>
            </div>
            
            <div class="flex items-center gap-6 mb-4 text-sm">
              <span class="flex items-center gap-1 text-primary shoutout-count" data-chart-id="${chart._id}">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.58C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/>
                </svg>
                <span class="shoutout-value">${this.api.formatNumber(chart.totalShoutouts || 0)}</span>
              </span>
              <span class="flex items-center gap-1 text-muted-foreground">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                </svg>
                ${chart.participants?.length || 1}/${chart.maxParticipants}
              </span>
              <span class="flex items-center gap-1 text-amber-600 dark:text-amber-400">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                <span class="donation-amount">${this.api.formatNumber(chart.totalDonations || 0)}</span>
              </span>
            </div>
            
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <span class="text-xs text-muted-foreground">
                  â° ${timeLeft}
                </span>
                <span class="text-xs ${spotsLeft > 0 ? 'text-success' : 'text-destructive'}">
                  ${spotsLeft > 0 ? `${spotsLeft} spot${spotsLeft > 1 ? 's' : ''} left` : 'Full'}
                </span>
              </div>
              <button class="px-6 py-2 bg-gradient-to-r from-primary to-accent text-white rounded-xl text-sm font-semibold shadow-lg shadow-primary/30 join-chart-btn" data-chart-id="${chart._id}">
                Join Now
              </button>
            </div>
          </div>
        `;
      }

      attachChartEvents() {
        document.querySelectorAll('.join-chart-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            this.joinChart(btn.dataset.chartId);
          });
        });
        
        document.querySelectorAll('.chart-card').forEach(card => {
          card.addEventListener('click', (e) => {
            if (!e.target.closest('button')) {
              window.location.href = `/chart?id=${card.dataset.chartId}`;
            }
          });
        });
        
        // Shoutout buttons
        document.querySelectorAll('[id^="shoutout-btn-"]').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            if (!this.api.token) {
              window.location.href = '/login';
              return;
            }
            const chartId = btn.id.replace('shoutout-btn-', '');
            this.toggleShoutout(chartId);
          });
        });
        
        // Donate buttons
        document.querySelectorAll('[id^="donate-btn-"]').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            if (!this.api.token) {
              window.location.href = '/login';
              return;
            }
            const chartId = btn.id.replace('donate-btn-', '');
            this.openDonationModal(chartId);
          });
        });
      }

      async loadLiveArenas() {
        const container = document.querySelector('.live-arenas');
        if (!container) return;
        
        try {
          const arenas = await this.api.getLiveArenas();
          this.renderLiveArenas(arenas);
        } catch (error) {
          container.innerHTML = '<div class="glass-card p-4 text-center text-destructive">Failed to load arenas</div>';
        }
      }

      renderLiveArenas(arenas) {
        const container = document.querySelector('.live-arenas');
        if (!container) return;
        
        if (!arenas || arenas.length === 0) {
          container.innerHTML = `
            <div class="glass-card p-6 text-center">
              <p class="text-muted-foreground">No live arenas at the moment</p>
            </div>
          `;
          return;
        }
        
        container.innerHTML = arenas.slice(0, 3).map(arena => `
          <div class="arena-card glass-card p-4 cursor-pointer hover:-translate-x-1 transition" data-arena-id="${arena._id}" onclick="app.viewArena('${arena._id}')">
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center -space-x-2">
                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white text-xs">
                  ${arena.players?.[0]?.user?.displayName?.charAt(0) || 'P1'}
                </div>
                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-green-400 to-teal-500 flex items-center justify-center text-white text-xs">
                  ${arena.players?.[1]?.user?.displayName?.charAt(0) || 'P2'}
                </div>
              </div>
              <span class="bg-destructive/10 text-destructive border border-destructive/20 px-2 py-0.5 rounded-full text-xs flex items-center gap-1">
                <span class="relative flex h-2 w-2">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-destructive opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2 w-2 bg-destructive"></span>
                </span>
                LIVE
              </span>
            </div>
            
            <div class="flex items-center justify-between mb-2">
              <div>
                <p class="text-sm font-medium">${arena.players?.[0]?.user?.displayName || 'Player 1'}</p>
                <p class="text-xs text-muted-foreground">${arena.players?.[0]?.score || 0} pts</p>
              </div>
              <span class="text-lg font-bold text-primary mx-2">VS</span>
              <div class="text-right">
                <p class="text-sm font-medium">${arena.players?.[1]?.user?.displayName || 'Player 2'}</p>
                <p class="text-xs text-muted-foreground">${arena.players?.[1]?.score || 0} pts</p>
              </div>
            </div>
            
            <div class="flex items-center justify-between mt-3 pt-3 border-t border-border">
              <div class="flex gap-3 text-xs">
                <span class="flex items-center gap-1 text-muted-foreground">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                  </svg>
                  ${arena.spectators?.length || 0}
                </span>
                <span class="flex items-center gap-1 text-warning">
                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  ${arena.chart?.game || 'Game'}
                </span>
              </div>
              <button class="glass-card px-3 py-1 text-xs rounded-full">
                Watch
              </button>
            </div>
          </div>
        `).join('');
        
        // Update viewer count
        const totalViewers = arenas.reduce((sum, a) => sum + (a.spectators?.length || 0), 0);
        document.querySelector('.live-viewers').textContent = this.api.formatNumber(totalViewers || 2300);
      }

      async loadLeaderboard() {
        try {
          const leaders = await this.api.getLeaderboard('reputation', 5);
          this.renderLeaderboard(leaders);
        } catch (error) {
          console.error('Failed to load leaderboard');
        }
      }

      renderLeaderboard(leaders) {
        const container = document.querySelector('.leaderboard-preview');
        if (!container) return;
        
        if (!leaders || leaders.length === 0) {
          container.innerHTML = '<p class="text-sm text-muted-foreground">No data</p>';
          return;
        }
        
        container.innerHTML = leaders.map((user, i) => `
          <div class="flex items-center gap-3 py-2 cursor-pointer hover:bg-muted/30 rounded-lg transition-colors" onclick="window.location.href='/profile?id=${user._id}'">
            <span class="w-6 text-sm font-semibold ${i < 3 ? 'text-primary' : 'text-muted-foreground'}">${i + 1}.</span>
            <div class="relative">
              <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary to-accent flex items-center justify-center text-white text-xs">
                ${user.displayName?.charAt(0) || 'U'}
              </div>
              ${user.isVerified ? '<span class="absolute -bottom-1 -right-1 verification-badge w-3 h-3 text-[8px]">âœ“</span>' : ''}
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium truncate" style="max-width: 100px">${user.displayName}</p>
            </div>
            <div class="text-right">
              <p class="text-sm font-semibold">${(user.reputation || 4.5).toFixed(2)}</p>
            </div>
          </div>
        `).join('');
      }

      async loadStats() {
        try {
          const stats = await this.api.getStats();
          document.querySelector('.open-arenas-count').textContent = stats.activeArenas || 24;
          document.querySelector('.players-waiting').textContent = stats.activePlayers || 156;
          document.querySelector('.total-backed').textContent = this.api.formatCurrency(stats.totalDonations || 2560);
          document.querySelector('.trending-count').textContent = this.api.formatNumber(stats.totalCharts || 234);
        } catch (error) {}
      }

      setupWebSocket() {
        this.api.connectWebSocket({
          onNotification: (notification) => {
            this.showToast(notification.title, notification.message, notification.type);
            this.updateNotificationBadge();
          },
          onUserStatus: (userId, status) => {
            // Update status indicators
            document.querySelectorAll(`[data-user-id="${userId}"] .user-status`).forEach(el => {
              el.className = `avatar-status ${status}`;
            });
          }
        });
      }

      async updateNotificationBadge() {
        if (!this.api.token) return;
        try {
          const data = await this.api.getNotifications(1);
          const badge = document.getElementById('notif-badge');
          if (badge) {
            if (data.unreadCount > 0) {
              badge.textContent = data.unreadCount > 99 ? '99+' : data.unreadCount;
              badge.classList.remove('hidden');
            } else {
              badge.classList.add('hidden');
            }
          }
        } catch (error) {}
      }

      showToast(title, message, type = 'info') {
        const container = document.getElementById('toast-container');
        if (!container) return;
        
        const toast = document.createElement('div');
        toast.className = `glass-card p-4 max-w-sm animate-slide-left border-l-4 ${
          type === 'donation' ? 'border-success' : 
          type === 'shoutout' ? 'border-primary' : 
          type === 'error' ? 'border-destructive' : 
          'border-warning'
        }`;
        
        toast.innerHTML = `
          <div class="flex items-start gap-3">
            <div class="flex-shrink-0">
              ${type === 'donation' ? 'ðŸ’°' : type === 'shoutout' ? 'ðŸ“¢' : type === 'error' ? 'âŒ' : 'ðŸ””'}
            </div>
            <div class="flex-1">
              <h4 class="font-semibold text-sm mb-1">${title}</h4>
              <p class="text-xs text-muted-foreground">${message}</p>
            </div>
            <button class="text-muted-foreground hover:text-foreground" onclick="this.parentElement.parentElement.remove()">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        `;
        
        container.appendChild(toast);
        setTimeout(() => toast.remove(), 5000);
      }

      openNotifications() {
        window.location.href = '/notifications';
      }

      async openCreateChartModal() {
        if (!this.api.token) {
          window.location.href = '/login';
          return;
        }
        
        // Check balance
        if ((this.api.user?.balance || 0) < 10) {
          this.showToast('Insufficient Balance', 'You need at least 10 THB', 'error');
          return;
        }
        
        // Simple prompt for demo
        const title = prompt('Enter chart title:');
        if (!title) return;
        
        const game = prompt('Enter game (e.g., Speed Chess):', 'Speed Chess');
        if (!game) return;
        
        const entryFee = prompt('Entry fee (THB):', '10');
        if (!entryFee) return;
        
        try {
          const chart = await this.api.createChart({
            title,
            game,
            entryFee: parseInt(entryFee),
            difficulty: 'intermediate',
            maxParticipants: 2,
            timeLimit: 5
          });
          
          this.showToast('Chart Created!', 'Your challenge is now live', 'success');
          this.loadFeed(true);
        } catch (error) {
          this.showToast('Error', error.message, 'error');
        }
      }

      async joinChart(chartId) {
        if (!this.api.token) {
          window.location.href = '/login';
          return;
        }
        
        try {
          await this.api.joinChart(chartId);
          this.showToast('Joined!', 'You joined the chart', 'success');
          this.loadFeed(true);
        } catch (error) {
          this.showToast('Failed to join', error.message, 'error');
        }
      }

      async toggleShoutout(chartId) {
        try {
          const chart = await this.api.getChart(chartId);
          await this.api.createShoutout({
            chartId,
            recipientId: chart.creator._id,
            message: ''
          });
          
          // Update UI
          const valEl = document.querySelector(`.shoutout-value[data-chart-id="${chartId}"]`);
          if (valEl) {
            valEl.textContent = this.api.formatNumber((chart.totalShoutouts || 0) + 1);
          }
          
          this.showToast('Shoutout Sent!', 'Thanks for supporting', 'shoutout');
        } catch (error) {
          this.showToast('Error', error.message, 'error');
        }
      }

      async openDonationModal(chartId) {
        const chart = await this.api.getChart(chartId);
        this.currentChart = chart;
        
        const modal = document.getElementById('donationModal');
        const recipientEl = document.querySelector('.donation-recipient');
        if (recipientEl) recipientEl.textContent = chart.creator.displayName;
        
        modal.classList.remove('hidden');
      }

      closeDonationModal() {
        document.getElementById('donationModal').classList.add('hidden');
        this.currentChart = null;
      }

      async processDonation() {
        if (!this.currentChart) {
          this.closeDonationModal();
          return;
        }
        
        const customAmount = document.getElementById('custom-amount');
        let amount = customAmount?.value ? parseInt(customAmount.value) : 25;
        
        if (!amount || amount < 10) {
          this.showToast('Invalid Amount', 'Minimum 10 THB', 'error');
          return;
        }
        
        if (amount > (this.api.user?.balance || 0)) {
          this.showToast('Insufficient Balance', 'Please deposit more funds', 'error');
          return;
        }
        
        const message = document.getElementById('donation-message')?.value || '';
        
        try {
          const donation = await this.api.createDonation({
            chartId: this.currentChart._id,
            recipientId: this.currentChart.creator._id,
            amount,
            message
          });
          
          // Update UI
          const amountEl = document.querySelector(`.donation-amount[data-chart-id="${this.currentChart._id}"]`);
          if (amountEl) {
            amountEl.textContent = this.api.formatNumber((this.currentChart.totalDonations || 0) + amount);
          }
          
          // Update user balance
          if (this.api.user) {
            this.api.user.balance = donation.balance;
            document.querySelectorAll('.user-balance, .user-balance-modal').forEach(el => {
              el.textContent = this.api.formatCurrency(donation.balance);
            });
          }
          
          this.showToast('Donation Sent!', `You donated ${this.api.formatCurrency(amount)}`, 'donation');
          this.closeDonationModal();
        } catch (error) {
          this.showToast('Error', error.message, 'error');
        }
      }

      quickJoinMatch() {
        if (!this.api.token) {
          window.location.href = '/login';
          return;
        }
        
        this.showToast('Finding Match', 'Searching for available charts...', 'info');
        // In a real app, this would find and join a random chart
        setTimeout(() => {
          this.showToast('No Matches', 'No available charts found. Create one!', 'warning');
        }, 2000);
      }

      async loadMoreCharts() {
        this.currentPage++;
        await this.loadFeed();
      }

      viewArena(arenaId) {
        window.location.href = `/arena?id=${arenaId}`;
      }

      getTimeLeft(dateString) {
        const start = new Date(dateString);
        const now = new Date();
        if (now > start) return 'Now';
        const mins = Math.floor((start - now) / 60000);
        if (mins < 1) return 'Soon';
        if (mins < 60) return `${mins}m`;
        return `${Math.floor(mins / 60)}h`;
      }
    }

    // Initialize app
    const app = new ThumbsApp();
    window.app = app;

    document.addEventListener('DOMContentLoaded', () => {
      app.init();
      
      // Preset amount handling
      document.querySelectorAll('.preset-amount').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.preset-amount').forEach(b => {
            b.classList.remove('bg-primary/10', 'border-primary');
          });
          this.classList.add('bg-primary/10', 'border-primary');
          
          const amt = this.dataset.amount || 25;
          document.getElementById('confirmDonation').innerHTML = `Donate ${amt} THB`;
        });
      });
    });
  </script>
</body>
</html>
